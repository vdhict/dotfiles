# Homebrew setup
set -gx HOMEBREW_NO_ANALYTICS 1
set -gx HOMEBREW_BUNDLE_FILE $XDG_CONFIG_HOME/homebrew/Brewfile
set -gx HOMEBREW_CASK_OPTS --no-quarantine
set -gx HOMEBREW_AUTO_UPDATE_SECS 86400

{{ if (eq .chezmoi.os "darwin") }}
# macOS Homebrew
if test -x /opt/homebrew/bin/brew
    eval (/opt/homebrew/bin/brew shellenv)
else if test -x /usr/local/bin/brew
    eval (/usr/local/bin/brew shellenv)
end

if set -q HOMEBREW_PREFIX
    update_path $HOMEBREW_PREFIX/bin
    update_path $HOMEBREW_PREFIX/opt/curl/bin
    update_path $HOMEBREW_PREFIX/opt/coreutils/libexec/gnubin
    update_path $HOMEBREW_PREFIX/opt/gnu-sed/libexec/gnubin
    update_path $HOMEBREW_PREFIX/opt/findutils/libexec/gnubin
end
{{ end }}

{{ if (eq .chezmoi.os "linux") }}
# Linux Homebrew
if test -x /home/linuxbrew/.linuxbrew/bin/brew
    eval (/home/linuxbrew/.linuxbrew/bin/brew shellenv)
else if test -x ~/.linuxbrew/bin/brew
    eval (~/.linuxbrew/bin/brew shellenv)
end

if set -q HOMEBREW_PREFIX
    update_path $HOMEBREW_PREFIX/bin
end
{{ end }}
